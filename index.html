<script>
    // Ваша новая ссылка на CSV (Лист Инфопанель)
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS0kYp4Zp2m9jmTRMTZoamaEUBfZg95n3YN_7f0YByCva_978_452f538CXgKhzveg-etToheOTaVCJ/pub?gid=1855124971&single=true&output=csv';

    async function updateDashboard() {
        try {
            const response = await fetch(csvUrl);
            const data = await response.text();
            
            // Разбиваем CSV на строки и ячейки
            const rows = data.split('\n').map(row => row.split(','));

            // В CSV ячейка B1 — это [0][1], B3 — это [2][1]
            // (Индексы начинаются с нуля: A=0, B=1; Строка 1=0, Строка 3=2)
            
            const status = rows[0][1]?.replace(/"/g, '') || "ОЖИДАНИЕ";
            const progress = rows[2][1]?.replace(/"/g, '') || "0 из 0";

            // Обновляем текст
            document.getElementById('status-container').innerText = status;
            document.getElementById('done-text').innerText = progress;

            // Считаем проценты для круга и текста
            const nums = progress.match(/\d+/g);
            if (nums && nums.length >= 2) {
                const done = parseInt(nums[0]);
                const total = parseInt(nums[1]);
                const percent = Math.min(Math.round((done / total) * 100), 100);
                
                document.getElementById('percent-val').innerText = percent + '%';
                
                // Если у вас есть элемент с id "circle-bar", обновляем его
                const circle = document.getElementById('circle-bar');
                if (circle) {
                    const offset = 628 - (628 * percent / 100);
                    circle.style.strokeDashoffset = offset;
                }
            }
        } catch (error) {
            console.error('Ошибка загрузки данных:', error);
        }
    }

    // Обновление каждые 10 секунд
    setInterval(updateDashboard, 10000);
    updateDashboard(); // Первый запуск
</script>